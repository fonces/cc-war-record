import{i as e}from"./rolldown-runtime-CIDIeb-o.js";import{T as t,x as n,y as r}from"./react-vendor-D1pS86Oe.js";import"./styled-DX7-lrl4.js";import"./jszip-DU7jsDXX.js";import"./i18n-THkEc1_o.js";import{A as i,S as a,T as o,_ as s,b as c,i as l,k as u,n as d,ot as f,r as p,s as m,st as h,y as g}from"./index-LFvlTMlv.js";import{t as _}from"./stores-BqsSbD7h.js";var v=e(t()),y=e(n());const b=()=>{let{t:e}=i();u(e(`pages.newSeason.title`));let t=r(),{createHistory:n,error:b,clearError:x,getSortedHistories:S}=_(),[C,w]=(0,v.useState)(``),[T,E]=(0,v.useState)(!1),[D,O]=(0,v.useState)(``),[k,A]=(0,v.useState)(``),[j,M]=(0,v.useState)(!1),N=async t=>{t.preventDefault();let n=C.trim();if(!n){O(e(`pages.newSeason.validationRequired`));return}if(n.length>20){O(e(`pages.newSeason.validationMaxLength`,{length:20}));return}if(O(``),S().length>0){M(!0);return}await P()},P=async()=>{E(!0),x();try{let r=C.trim(),i=n({seasonName:r});A(e(`pages.newSeason.successMessage`,{seasonName:i.seasonName})),setTimeout(()=>{t.navigate({to:`/`})},1500)}catch(e){console.error(`シーズン作成エラー:`,e)}finally{E(!1),M(!1)}},F=()=>{P()},I=()=>{M(!1)},L=()=>{history.back()},R=e=>{w(e.target.value),D&&O(``)},z=S()[0]?.seasonName||``;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o,{isOpen:j,onClose:I,title:e(`pages.newSeason.confirmTitle`),confirmText:e(`pages.newSeason.create`),cancelText:e(`pages.newSeason.cancel`),onConfirm:F,confirmType:`danger`,isLoading:T,children:e(`pages.newSeason.confirmDescription`,{seasonName:z})}),(0,y.jsxs)(s,{children:[(0,y.jsx)(a,{children:(0,y.jsx)(c,{children:e(`pages.newSeason.title`)})}),(0,y.jsx)(g,{children:e(`pages.newSeason.description`)}),(0,y.jsxs)(d,{onSubmit:N,children:[(b||D)&&(0,y.jsx)(m,{type:`error`,onClose:()=>{O(``),x()},children:D||b}),k&&(0,y.jsx)(m,{type:`success`,children:k}),(0,y.jsx)(l,{children:(0,y.jsx)(f,{label:e(`pages.newSeason.seasonName`),type:`text`,value:C,onChange:R,placeholder:e(`pages.newSeason.seasonNamePlaceholder`),disabled:T||!!k,fullWidth:!0,required:!0})}),(0,y.jsxs)(p,{children:[(0,y.jsx)(h,{type:`button`,variant:`outline`,onClick:L,disabled:T||!!k,children:e(`pages.newSeason.cancel`)}),(0,y.jsx)(h,{type:`submit`,disabled:T||!!k||!C.trim(),children:e(T?`pages.newSeason.creating`:`pages.newSeason.create`)})]})]})]})]})};export{b as NewSeasonPage};