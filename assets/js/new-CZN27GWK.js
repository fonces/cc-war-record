import{i as e}from"./rolldown-runtime-CescaEWC.js";import{kt as t}from"./vendor-CfpF3efx.js";import{b as n,y as r}from"./vendor-react-Dqtmilgm.js";import"./vendor-styled-zRjDkof3.js";import"./vendor-jszip-BemITh_p.js";import"./vendor-i18n-DFMPNbhM.js";import{C as i,M as a,N as o,O as s,b as c,c as l,ft as u,i as d,mt as f,n as p,r as m,v as h,x as g}from"./index-C5jF5Hv-.js";import{t as _}from"./stores-C0mYd_Ps.js";var v=e(t()),y=e(n());const b=()=>{let{t:e}=o();a(e(`pages.newSeason.title`));let t=r(),{createHistory:n,error:b,clearError:x,getSortedHistories:S}=_(),[C,w]=(0,v.useState)(``),[T,E]=(0,v.useState)(!1),[D,O]=(0,v.useState)(``),[k,A]=(0,v.useState)(``),[j,M]=(0,v.useState)(!1),N=async t=>{t.preventDefault();let n=C.trim();if(!n){O(e(`pages.newSeason.validationRequired`));return}if(n.length>20){O(e(`pages.newSeason.validationMaxLength`,{length:20}));return}if(O(``),S().length>0){M(!0);return}await P()},P=async()=>{E(!0),x();try{let r=C.trim(),i=n({seasonName:r});A(e(`pages.newSeason.successMessage`,{seasonName:i.seasonName})),setTimeout(()=>{t.navigate({to:`/`})},1500)}catch(e){console.error(`シーズン作成エラー:`,e)}finally{E(!1),M(!1)}},F=()=>{P()},I=()=>{M(!1)},L=()=>{history.back()},R=e=>{w(e.target.value),D&&O(``)},z=S()[0]?.seasonName||``;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(s,{isOpen:j,onClose:I,title:e(`pages.newSeason.confirmTitle`),confirmText:e(`pages.newSeason.create`),cancelText:e(`pages.newSeason.cancel`),onConfirm:F,confirmType:`danger`,isLoading:T,children:e(`pages.newSeason.confirmDescription`,{seasonName:z})}),(0,y.jsxs)(h,{children:[(0,y.jsx)(i,{children:(0,y.jsx)(g,{children:e(`pages.newSeason.title`)})}),(0,y.jsx)(c,{children:e(`pages.newSeason.description`)}),(0,y.jsxs)(p,{onSubmit:N,children:[(b||D)&&(0,y.jsx)(l,{type:`error`,onClose:()=>{O(``),x()},children:D||b}),k&&(0,y.jsx)(l,{type:`success`,children:k}),(0,y.jsx)(d,{children:(0,y.jsx)(u,{label:e(`pages.newSeason.seasonName`),type:`text`,value:C,onChange:R,placeholder:e(`pages.newSeason.seasonNamePlaceholder`),disabled:T||!!k,fullWidth:!0,required:!0})}),(0,y.jsxs)(m,{children:[(0,y.jsx)(f,{type:`button`,variant:`outline`,onClick:L,disabled:T||!!k,children:e(`pages.newSeason.cancel`)}),(0,y.jsx)(f,{type:`submit`,disabled:T||!!k||!C.trim(),children:e(T?`pages.newSeason.creating`:`pages.newSeason.create`)})]})]})]})]})};export{b as NewSeasonPage};