import{$ as e,T as t,_ as n,_t as r,dt as i,et as a,g as o,i as s,lt as c,mt as l,n as u,o as d,r as f,v as p,w as m,x as h,y as g}from"./index-BBYhvlPi.js";import{t as _}from"./stores-ByG3wVEh.js";var v=r(l()),y=r(i());const b=()=>{let{t:r}=t();m(r(`pages.newSeason.title`));let i=c(),{createHistory:l,error:b,clearError:x,getSortedHistories:S}=_(),[C,w]=(0,v.useState)(``),[T,E]=(0,v.useState)(!1),[D,O]=(0,v.useState)(``),[k,A]=(0,v.useState)(``),[j,M]=(0,v.useState)(!1),N=async e=>{e.preventDefault();let t=C.trim();if(!t){O(r(`pages.newSeason.validationRequired`));return}if(t.length>20){O(r(`pages.newSeason.validationMaxLength`,{length:20}));return}if(O(``),S().length>0){M(!0);return}await P()},P=async()=>{E(!0),x();try{let e=C.trim(),t=l({seasonName:e});A(r(`pages.newSeason.successMessage`,{seasonName:t.seasonName})),setTimeout(()=>{i.navigate({to:`/`})},1500)}catch(e){console.error(`シーズン作成エラー:`,e)}finally{E(!1),M(!1)}},F=()=>{P()},I=()=>{M(!1)},L=()=>{history.back()},R=e=>{w(e.target.value),D&&O(``)},z=S()[0]?.seasonName||``;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(h,{isOpen:j,onClose:I,title:r(`pages.newSeason.confirmTitle`),confirmText:r(`pages.newSeason.create`),cancelText:r(`pages.newSeason.cancel`),onConfirm:F,confirmType:`danger`,isLoading:T,children:r(`pages.newSeason.confirmDescription`,{seasonName:z})}),(0,y.jsxs)(o,{children:[(0,y.jsx)(g,{children:(0,y.jsx)(p,{children:r(`pages.newSeason.title`)})}),(0,y.jsx)(n,{children:r(`pages.newSeason.description`)}),(0,y.jsxs)(u,{onSubmit:N,children:[(b||D)&&(0,y.jsx)(d,{type:`error`,onClose:()=>{O(``),x()},children:D||b}),k&&(0,y.jsx)(d,{type:`success`,children:k}),(0,y.jsx)(s,{children:(0,y.jsx)(e,{label:r(`pages.newSeason.seasonName`),type:`text`,value:C,onChange:R,placeholder:r(`pages.newSeason.seasonNamePlaceholder`),disabled:T||!!k,fullWidth:!0,required:!0})}),(0,y.jsxs)(f,{children:[(0,y.jsx)(a,{type:`button`,variant:`outline`,onClick:L,disabled:T||!!k,children:r(`pages.newSeason.cancel`)}),(0,y.jsx)(a,{type:`submit`,disabled:T||!!k||!C.trim(),children:r(T?`pages.newSeason.creating`:`pages.newSeason.create`)})]})]})]})]})};export{b as NewSeasonPage};